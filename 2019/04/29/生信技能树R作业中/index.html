<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta name="baidu-site-verification" content="T4rWknjJ0o">
  <meta name="google-site-verification" content="DKxSiJ2DGL4xBMuDXo4NcK14_fFgVTMwfgjG_CzT7RA">
  <meta charset="utf-8">
  
  <title>生信技能树R作业答案-中 | K2 life</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
  <meta name="keywords" content="R统计生物信息学">
  
  
    <meta name="google-site-verification" content="true">
  
  
    <meta name="baidu-site-verification" content="bFQQUchCY1">
  
  
  <meta name="description" content="#作业在这里 123456789101112131415161718192021222324252627282930rm(list = ls()) options()$repos options()$BioC_mirroroptions(BioC_mirror=&amp;quot;https://mirrors.ustc.edu.cn/bioc/&amp;quot;)options(&amp;quot;repos&amp;quo">
<meta name="keywords" content="R,统计,生物信息学">
<meta property="og:type" content="article">
<meta property="og:title" content="生信技能树R作业答案-中">
<meta property="og:url" content="www.ucco.net/2019/04/29/生信技能树R作业中/index.html">
<meta property="og:site_name" content="K2 life">
<meta property="og:description" content="#作业在这里 123456789101112131415161718192021222324252627282930rm(list = ls()) options()$repos options()$BioC_mirroroptions(BioC_mirror=&amp;quot;https://mirrors.ustc.edu.cn/bioc/&amp;quot;)options(&amp;quot;repos&amp;quo">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2019-04-28T03:55:13.744Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="生信技能树R作业答案-中">
<meta name="twitter:description" content="#作业在这里 123456789101112131415161718192021222324252627282930rm(list = ls()) options()$repos options()$BioC_mirroroptions(BioC_mirror=&amp;quot;https://mirrors.ustc.edu.cn/bioc/&amp;quot;)options(&amp;quot;repos&amp;quo">
  
    <link rel="alternate" href="/atom.xml" title="K2 life" type="application/atom+xml">
  
  <link rel="icon" href="/css/images/favicon.ico">
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link href="https://fonts.googleapis.com/css?family=Open+Sans|Montserrat:700" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Roboto:400,300,300italic,400italic" rel="stylesheet" type="text/css">
  <link href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">
  <style type="text/css">
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/9749f0/00000000000000000001008f/27/l?subset_id=2&fvd=n5) format("woff2");font-weight:500;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/90cf9f/000000000000000000010091/27/l?subset_id=2&fvd=n7) format("woff2");font-weight:500;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/8a5494/000000000000000000013365/27/l?subset_id=2&fvd=n4) format("woff2");font-weight:lighter;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/d337d8/000000000000000000010095/27/l?subset_id=2&fvd=i4) format("woff2");font-weight:400;font-style:italic;}</style>
    
  <link rel="stylesheet" id="athemes-headings-fonts-css" href="//fonts.googleapis.com/css?family=Yanone+Kaffeesatz%3A200%2C300%2C400%2C700&amp;ver=4.6.1" type="text/css" media="all">

  <link rel="stylesheet" id="athemes-headings-fonts-css" href="//fonts.googleapis.com/css?family=Oswald%3A300%2C400%2C700&amp;ver=4.6.1" type="text/css" media="all">
  <link rel="stylesheet" href="/css/style.css">

  <script src="/js/jquery-3.1.1.min.js"></script>

  <!-- Bootstrap core CSS -->
  <link rel="stylesheet" href="/css/bootstrap.css">
  <link rel="stylesheet" href="/css/fashion.css">
  <link rel="stylesheet" href="/css/glyphs.css">

</head>
</html>


  <body data-spy="scroll" data-target="#toc" data-offset="50">


  


<header id="allheader" class="site-header" role="banner">
  <div class="clearfix container">
      <div class="site-branding">

          <h1 class="site-title">
            
              <a href="/" title="K2 life" rel="home"> K2 life </a>
            
          </h1>
          
          
            
          <nav id="main-navigation" class="main-navigation" role="navigation">
            <a class="nav-open">Menu</a>
            <a class="nav-close">Close</a>

            <div class="clearfix sf-menu">
              <ul id="main-nav" class="menu sf-js-enabled sf-arrows" style="touch-action: pan-y;">
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class href="/">首页</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class href="/categories">分类</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class href="/tags">标签</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class href="/archives">归档</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class href="/links">links</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class href="/about">关于</a> </li>
                    
              </ul>
            </div>
          </nav>

      </div>
  </div>
</header>


  <div id="container">
    <div id="wrap">
            
      <div id="content" class="outer">
        
          <section id="main" style="float:none;"><article id="post-生信技能树R作业中" style="width: 66%; float:left;" class="article article-type-post" itemscope itemprop="blogPost">
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      生信技能树R作业答案-中
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2019/04/29/生信技能树R作业中/" class="article-date">
	  <time datetime="2019-04-29T07:24:53.966Z" itemprop="datePublished">四月 29, 2019</time>
	</a>

      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/categories/R/">R</a>
 
      
	<span id="busuanzi_container_page_pv">
	  本文总阅读量<span id="busuanzi_value_page_pv"></span>次
	</span>

    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p>#<a href="http://www.bio-info-trainee.com/3750.html" target="_blank" rel="noopener">作业在这里</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">rm(list = ls()) </span><br><span class="line">options()$repos </span><br><span class="line">options()$BioC_mirror</span><br><span class="line">options(BioC_mirror=&quot;https://mirrors.ustc.edu.cn/bioc/&quot;)</span><br><span class="line">options(&quot;repos&quot; = c(CRAN=&quot;https://mirrors.tuna.tsinghua.edu.cn/CRAN/&quot;))</span><br><span class="line">options()$repos </span><br><span class="line">options()$BioC_mirror</span><br><span class="line"># https://bioconductor.org/packages/release/bioc/html/GEOquery.html</span><br><span class="line">if (!requireNamespace(&quot;BiocManager&quot;, quietly = TRUE))</span><br><span class="line">  install.packages(&quot;BiocManager&quot;)</span><br><span class="line">BiocManager::install(&quot;KEGG.db&quot;,ask = F,update = F)</span><br><span class="line">BiocManager::install(c(&quot;GSEABase&quot;,&quot;GSVA&quot;,&quot;clusterProfiler&quot; ),ask = F,update = F)</span><br><span class="line">BiocManager::install(c(&quot;GEOquery&quot;,&quot;limma&quot;,&quot;impute&quot; ),ask = F,update = F)</span><br><span class="line">BiocManager::install(c(&quot;genefu&quot;,&quot;org.Hs.eg.db&quot;,&quot;hgu133plus2.db&quot; ),ask = F,update = F)</span><br><span class="line">options()$repos</span><br><span class="line">install.packages(&apos;WGCNA&apos;)</span><br><span class="line">install.packages(c(&quot;FactoMineR&quot;, &quot;factoextra&quot;))</span><br><span class="line">install.packages(c(&quot;ggplot2&quot;, &quot;pheatmap&quot;,&quot;ggpubr&quot;))</span><br><span class="line">library(&quot;FactoMineR&quot;)</span><br><span class="line">library(&quot;factoextra&quot;)</span><br><span class="line">library(GSEABase)</span><br><span class="line">library(GSVA)</span><br><span class="line">library(clusterProfiler)</span><br><span class="line">library(genefu)</span><br><span class="line">library(ggplot2)</span><br><span class="line">library(ggpubr)</span><br><span class="line">library(hgu133plus2.db)</span><br><span class="line">library(limma)</span><br><span class="line">library(org.Hs.eg.db)</span><br><span class="line">library(pheatmap)</span><br></pre></td></tr></table></figure>
<h1 id="task1-通过r注释包从ensemble到symbol"><a class="markdownIt-Anchor" href="#task1-通过r注释包从ensemble到symbol"></a> Task1: 通过R注释包从ensemble到symbol</h1>
<blockquote>
<p>请根据R包org.Hs.eg.db找到下面ensembl 基因ID 对应的基因名(symbol)</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># ENSG00000000003.13</span><br><span class="line"># ENSG00000000005.5</span><br><span class="line"># ENSG00000000419.11</span><br><span class="line"># ENSG00000000457.12</span><br><span class="line"># ENSG00000000460.15</span><br><span class="line"># ENSG00000000938.11</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">library(org.Hs.eg.db)</span><br><span class="line">ls(&quot;package:org.Hs.eg.db&quot;)</span><br><span class="line">g2s &lt;- toTable(org.Hs.egSYMBOL)</span><br><span class="line">g2e &lt;- toTable(org.Hs.egENSEMBL)</span><br><span class="line">head(g2s)</span><br><span class="line">head(g2e)</span><br><span class="line">g2se &lt;- merge(g2s, g2e, by=&apos;gene_id&apos;)</span><br><span class="line">head(g2se)</span><br><span class="line">ensID1 &lt;- c(&quot;ENSG00000000003.13&quot;,&quot;ENSG00000000005.5&quot;,&quot;ENSG00000000419.11&quot;,</span><br><span class="line">           &quot;ENSG00000000457.12&quot;,&quot;ENSG00000000460.15&quot;,&quot;ENSG00000000938.11&quot;)</span><br><span class="line">ensID &lt;- data.frame(ensID1)</span><br></pre></td></tr></table></figure>
<h2 id="method1for循环"><a class="markdownIt-Anchor" href="#method1for循环"></a> Method1:for循环</h2>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">for (i in 1:nrow(ensID)) &#123;</span><br><span class="line">  ens_i &lt;- strsplit(as.character(ensID[i,1]),&apos;.&apos;,fixed = TRUE)[[1]][1]</span><br><span class="line">  ensID[i,2]&lt;-ens_i</span><br><span class="line">&#125;</span><br><span class="line">ensID$ensembl_id  &lt;- NULL</span><br><span class="line">colnames(ensID)[1] &lt;- &apos;ensembl_id&apos; </span><br><span class="line">ensID_last &lt;- merge(ensID, g2se, &apos;ensembl_id&apos;)</span><br><span class="line">ensID_last</span><br></pre></td></tr></table></figure>
<h2 id="method2apply函数"><a class="markdownIt-Anchor" href="#method2apply函数"></a> Method2:apply函数</h2>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ensID$ensembl_id &lt;- unlist(lapply(ensID1,  function(x) &#123;strsplit(as.character(x),&apos;.&apos;,fixed = TRUE)[[1]][1]</span><br><span class="line">  &#125;))</span><br><span class="line">ensID_last2 &lt;- merge(ensID, g2se,&quot;ensembl_id&quot;)</span><br></pre></td></tr></table></figure>
<h1 id="task2由探针找到对应的基因名"><a class="markdownIt-Anchor" href="#task2由探针找到对应的基因名"></a> Task2:由探针找到对应的基因名</h1>
<blockquote>
<p>根据R包hgu133a.db找到下面探针对应的基因名(symbol)<br>
053_at<br>
117_at<br>
121_at<br>
1255_g_at<br>
1316_at<br>
1320_at<br>
1405_i_at<br>
1431_at<br>
1438_at<br>
1487_at<br>
1494_f_at<br>
1598_g_at<br>
160020_at<br>
1729_at<br>
177_at</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">library(hgu133a.db)</span><br><span class="line">ids &lt;- toTable(hgu133aSYMBOL)</span><br><span class="line">head(ids)</span><br><span class="line">myids &lt;- read.table(file = &quot;my_probe_ids.txt&quot;)</span><br><span class="line">colnames(myids) &lt;- &quot;probe_id&quot;</span><br><span class="line">myid_sym &lt;- merge(myids, ids, by=&quot;probe_id&quot;)</span><br><span class="line">head(myid_sym)</span><br></pre></td></tr></table></figure>
<h1 id="task3-找某个基因在表达矩阵中的值并分组绘图"><a class="markdownIt-Anchor" href="#task3-找某个基因在表达矩阵中的值并分组绘图"></a> Task3 找某个基因在表达矩阵中的值并分组绘图</h1>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># 找到R包CLL内置的数据集的表达矩阵里面的TP53基因的表达量，并且绘制在 progres.-stable分组的boxplot图</span><br><span class="line"># 提示：</span><br><span class="line"># suppressPackageStartupMessages(library(CLL))</span><br><span class="line"># data(sCLLex)</span><br><span class="line"># sCLLex</span><br><span class="line"># exprSet=exprs(sCLLex)   </span><br><span class="line"># library(hgu95av2.db)</span><br></pre></td></tr></table></figure>
<p>以下是代码部分</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">rm(list=ls())</span><br><span class="line">library(CLL)</span><br><span class="line">data(sCLLex)</span><br><span class="line">expr &lt;- exprs(sCLLex)</span><br><span class="line">pdata &lt;- pData(sCLLex)</span><br><span class="line">head(expr)</span><br><span class="line">library(hgu95av2.db)</span><br><span class="line">probe_sym &lt;- toTable(hgu95av2SYMBOL)</span><br><span class="line">tp53_probes &lt;- probe_sym[grep(&quot;TP53$&quot;, probe_sym$symbol),]</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># probe_id symbol</span><br><span class="line"># 966    1939_at   TP53</span><br><span class="line"># 997  1974_s_at   TP53</span><br><span class="line"># 1420  31618_at   TP53</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">boxplot(expr[&apos;1939_at&apos;,]~pdata$Disease)</span><br></pre></td></tr></table></figure>
<p>ggpubr<br>
<a href="http://www.sthda.com/english/articles/24-ggpubr-publication-ready-plots/" target="_blank" rel="noopener">http://www.sthda.com/english/articles/24-ggpubr-publication-ready-plots/</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">library(ggpubr)</span><br><span class="line">tp53_pub &lt;- cbind(expr[&apos;1939_at&apos;,], as.data.frame(pdata$Disease))</span><br><span class="line">colnames(tp53_pub) &lt;- c(&apos;Expression&apos;,&quot;Group&quot;)</span><br><span class="line">p &lt;- ggboxplot(tp53_pub, y=&apos;Expression&apos;, x=&apos;Group&apos;,fill = &apos;Group&apos;, </span><br><span class="line">            palette = &apos;aaas&apos; ,add = &apos;jitter&apos;)</span><br><span class="line"># &quot;npg&quot;, &quot;aaas&quot;, &quot;lancet&quot;, &quot;jco&quot;, &quot;ucscgb&quot;, &quot;uchicago&quot;, &quot;simpsons&quot; &quot;rickandmorty&quot;</span><br><span class="line">p + stat_compare_means()</span><br><span class="line">p + stat_compare_means(method = &apos;t.test&apos;)</span><br><span class="line">#the violin plot</span><br><span class="line">my_comparisons &lt;- list(c(&quot;progress.&quot;, &quot;stable&quot;))</span><br><span class="line">ggviolin(tp53_pub, y=&apos;Expression&apos;, x=&apos;Group&apos;,fill = &apos;Group&apos;, </span><br><span class="line">         palette = &apos;aaas&apos; ,add = &apos;boxplot&apos;, add.params = list(fill = &apos;white&apos;))+</span><br><span class="line">         stat_compare_means(comparisons = my_comparisons, method = &quot;t.test&quot;)+</span><br><span class="line">         stat_compare_means(label.y = 5)</span><br></pre></td></tr></table></figure>
<h1 id="task4对任意肿瘤的任意基因进行分类做图用cbioportal"><a class="markdownIt-Anchor" href="#task4对任意肿瘤的任意基因进行分类做图用cbioportal"></a> Task4:对任意肿瘤的任意基因进行分类做图（用cBioPortal）</h1>
<blockquote>
<p>cbioportal下载，即利用在线数据（下载），本地进行改观<br>
<a href="http://www.cbioportal.org/index.do" target="_blank" rel="noopener">http://www.cbioportal.org/index.do</a><br>
Select Studies 选项中输入Breast Invasive Carcinoma PanCancer 搜索并选中目标数据集<br>
Enter Genes 数据框中输入目标基因BRCA1<br>
点击Submit Query提交搜索请求<br>
结果页面中，Plots选项卡选择合适数据进行绘图，或下载数据</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">rm(list = ls())</span><br><span class="line">options(stringsAsFactors = F)</span><br><span class="line">a=read.table(&apos;e4-plot.txt&apos;,sep = &apos;\t&apos;,fill = T,header = T)</span><br><span class="line">View(a)</span><br><span class="line">colnames(a)=c(&apos;id&apos;,&apos;subtype&apos;,&apos;expression&apos;,&apos;mut&apos;)</span><br><span class="line">dat=a</span><br><span class="line">library(ggstatsplot)</span><br><span class="line">ggbetweenstats(data =dat, x = subtype,  y = expression)</span><br><span class="line">library(ggplot2)</span><br><span class="line">ggsave(&apos;plot-again-BRCA1-TCGA-BRCA-cbioportal.png&apos;)</span><br></pre></td></tr></table></figure>
<h1 id="task5某基因在某肿瘤中的生存曲线作图美化"><a class="markdownIt-Anchor" href="#task5某基因在某肿瘤中的生存曲线作图美化"></a> Task5:某基因在某肿瘤中的生存曲线作图美化</h1>
<blockquote>
<p>找到TP53基因在TCGA数据库的乳腺癌数据集的表达量分组看其是否影响生存<br>
提示使用：<a href="http://www.oncolnc.org/" target="_blank" rel="noopener">http://www.oncolnc.org/</a><br>
值得商榷的问题，low和high分组问题，若50：50分组，无差异<br>
个人理解，这里不必平分，可以30：30，也就是就挑高和低的30%，这是可以说明问题的</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">rm(list = ls())</span><br><span class="line">options(stringsAsFactors = F)</span><br><span class="line">a=read.table(&apos;BRCA_7157_50_50.csv&apos;,sep = &apos;,&apos;,fill = T,header = T)</span><br><span class="line">#View(a)</span><br><span class="line">dat=a</span><br><span class="line">library(ggplot2)</span><br><span class="line">library(survival)</span><br><span class="line">library(survminer) </span><br><span class="line">table(dat$Status)</span><br><span class="line">dat$Status=ifelse(dat$Status==&apos;Dead&apos;,1,0)</span><br><span class="line">sfit &lt;- survfit(Surv(Days, Status)~Group, data=dat)</span><br><span class="line">sfit</span><br><span class="line">summary(sfit)</span><br><span class="line">ggsurvplot(sfit, conf.int=F, pval=TRUE)</span><br><span class="line">ggsave(&apos;survival_TP53_in_BRCA_TCGA.png&apos;)</span><br></pre></td></tr></table></figure>
<h1 id="task6geo下载表达数据并提取特定的基因做热图要去重复"><a class="markdownIt-Anchor" href="#task6geo下载表达数据并提取特定的基因做热图要去重复"></a> Task6：GEO下载表达数据并提取特定的基因做热图（要去重复）</h1>
<blockquote>
<p>下载数据集GSE17215的表达矩阵并且提取下面的基因画热图<br>
ACTR3B ANLN BAG1 BCL2 BIRC5 BLVRA CCNB1 CCNE1 CDC20 CDC6 CDCA1 CDH3<br>
CENPF CEP55 CXXC5 EGFR ERBB2 ESR1 EXO1 FGFR4 FOXA1 FOXC1 GPR160 GRB7<br>
KIF2C KNTC2 KRT14 KRT17 KRT5 MAPT MDM2 MELK MIA MKI67 MLPH MMP11 MYBL2<br>
MYC NAT1 ORC6L PGR PHGDH PTTG1 RRM2 SFRP1 SLC39A6 TMEM45B TYMS UBE2C UBE2T<br>
GSE17215数据在https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE17215<br>
可知，是U133A的芯片数据,共6个样本<br>
title为Expression data from paclitaxel and salinomycin-treated HMLER breast cancer cells</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">library(hgu133a.db)</span><br></pre></td></tr></table></figure>
<h2 id="有三种方法得到表达数据"><a class="markdownIt-Anchor" href="#有三种方法得到表达数据"></a> 有三种方法得到表达数据</h2>
<h3 id="1下载cel格式文件自己进行处理"><a class="markdownIt-Anchor" href="#1下载cel格式文件自己进行处理"></a> 1.下载.CEL格式文件，自己进行处理</h3>
<h3 id="2手动下载series-matrix-files然后读入"><a class="markdownIt-Anchor" href="#2手动下载series-matrix-files然后读入"></a> 2.手动下载series Matrix Files，然后读入</h3>
<h3 id="3利用r下载表达数据"><a class="markdownIt-Anchor" href="#3利用r下载表达数据"></a> 3.利用R下载表达数据</h3>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">library(GEOquery)</span><br><span class="line">library(GEOquery)</span><br><span class="line">#GEO使用https://www.bioconductor.org/packages/release/bioc/vignettes/GEOquery/inst/doc/GEOquery.html</span><br><span class="line">gse17215 &lt;- getGEO(&apos;GSE17215&apos;,</span><br><span class="line">                   AnnotGPL = F,     ## 注释文件</span><br><span class="line">                   getGPL = F)       ## 平台文件</span><br><span class="line">show(gse17215)</span><br><span class="line">dat &lt;- exprs(gse17215[[1]])</span><br><span class="line">pdata_17215 &lt;- pData(gse17215[[1]])</span><br><span class="line">pdata_17215$`agent:ch1`</span><br><span class="line"></span><br><span class="line">#提取hgu133a包中的probe_id和symbol</span><br><span class="line">ids &lt;- toTable(hgu133aSYMBOL)</span><br><span class="line">dat &lt;- dat[ids$probe_id,]#合并，也可以用merge</span><br><span class="line">#这里有个问题，一共50个基因名，但是得到的是87个探针，也就是有一个gene对应几个探针的情况</span><br><span class="line">#怎么处理？ 取median或者去p最小的,也有取均值的,</span><br><span class="line">#先把median加到ids最后一列</span><br><span class="line">ids$median &lt;- apply(dat, 1, median)</span><br><span class="line">head(ids)</span><br><span class="line">ids &lt;- ids[order(ids$symbol, ids$median, decreasing = T),]</span><br><span class="line">head(ids)</span><br><span class="line">ids_dup &lt;- ids[!duplicated(ids$symbol),]</span><br><span class="line">head(ids_dup)</span><br><span class="line">dat &lt;- dat[ids_dup$probe_id,]</span><br><span class="line">dim(dat)</span><br><span class="line">#这样就得到了去重重复的探针在6个样本中的表达信息，但没有基因名</span><br><span class="line">dat &lt;- as.data.frame(dat)</span><br><span class="line">dat$probe_id &lt;- rownames(dat)</span><br><span class="line">dat_symbol &lt;- merge(dat, ids, by =&quot;probe_id&quot;)</span><br><span class="line">#载入50个基因名</span><br><span class="line">genes &lt;- &apos;ACTR3B ANLN BAG1 BCL2 BIRC5 BLVRA CCNB1 CCNE1 CDC20 CDC6 CDCA1 CDH3 CENPF CEP55 CXXC5 EGFR ERBB2 ESR1 EXO1 FGFR4 FOXA1 FOXC1 GPR160 GRB7 KIF2C KNTC2 KRT14 KRT17 KRT5 MAPT MDM2 MELK MIA MKI67 MLPH MMP11 MYBL2 MYC NAT1 ORC6L PGR PHGDH PTTG1 RRM2 SFRP1 SLC39A6 TMEM45B TYMS UBE2C UBE2T&apos;</span><br><span class="line">genes &lt;- strsplit(genes, &apos; &apos;)[[1]]</span><br><span class="line">genes &lt;- data.frame(genes)</span><br><span class="line">colnames(genes) &lt;- &apos;symbol&apos;</span><br><span class="line">genes_expr &lt;- merge(genes, dat_symbol, by =&apos;symbol&apos;)</span><br><span class="line">#至此完成了探针过滤，加基因名等操作</span><br><span class="line">#取对数</span><br><span class="line">genes_expr &lt;- log2(dat+1)</span><br><span class="line">heat_expr &lt;- genes_expr[,-c(2,9)]</span><br><span class="line">rownames(heat_expr) &lt;- heat_expr$symbol </span><br><span class="line">heat_expr &lt;- heat_expr[,-1]</span><br><span class="line">heat_expr &lt;- log2(heat_expr+1)</span><br><span class="line">pheatmap::pheatmap(heat_expr, scale = &apos;row&apos;)</span><br><span class="line">ggcorrplot::ggcorrplot(cor(heat_expr))</span><br></pre></td></tr></table></figure>
<h1 id="task7geo下载表达矩阵做样本的相关性热图需要标记样本分组信息"><a class="markdownIt-Anchor" href="#task7geo下载表达矩阵做样本的相关性热图需要标记样本分组信息"></a> Task7:GEO下载表达矩阵做样本的相关性热图，需要标记样本分组信息</h1>
<blockquote>
<p>作业7<br>
下载数据集GSE24673的表达矩阵计算样本的相关性并且绘制热图，需要标记上样本分组信息<br>
数据地址https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE24673</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">rm(list=ls())</span><br><span class="line">options(stringsAsFactors = F)   </span><br><span class="line">gse24673 &lt;- getGEO(&apos;GSE24673&apos;,</span><br><span class="line">                   AnnotGPL = F,     ## 注释文件</span><br><span class="line">                   getGPL = F)       ## 平台文件</span><br><span class="line">show(gse24673)</span><br><span class="line">dat &lt;- exprs(gse24673[[1]])</span><br><span class="line">pdata_24673 &lt;- pData(gse24673[[1]]) </span><br><span class="line">pdata_24673 &lt;- pdata_24673$source_name_ch1</span><br><span class="line">pdata_24673 &lt;- data.frame(Group = pdata_24673)</span><br><span class="line">#添加分组信息</span><br><span class="line">rownames(pdata_24673) &lt;- colnames(cor_dat)</span><br><span class="line">pheatmap::pheatmap(cor_dat, annotation_col=pdata_24673)</span><br></pre></td></tr></table></figure>
<h1 id="task8-找到芯片对应平台的注释包并进行安装"><a class="markdownIt-Anchor" href="#task8-找到芯片对应平台的注释包并进行安装"></a> Task8： 找到芯片对应平台的注释包并进行安装</h1>
<blockquote>
<p>找到 GPL6244 platform of Affymetrix Human Gene 1.0 ST Array 对应的R的bioconductor注释包，并且安装它！<br>
参考http://www.bio-info-trainee.com/1399.html</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">options()$repos</span><br><span class="line">options()$BioC_mirror </span><br><span class="line">options(BioC_mirror=&quot;https://mirrors.ustc.edu.cn/bioc/&quot;)</span><br><span class="line">options(&quot;repos&quot; = c(CRAN=&quot;https://mirrors.tuna.tsinghua.edu.cn/CRAN/&quot;))</span><br><span class="line">BiocManager::install(&quot;hugene10sttranscriptcluster.db&quot;,ask = F,update = F)</span><br><span class="line">options()$repos</span><br><span class="line">options()$BioC_mirror</span><br></pre></td></tr></table></figure>
<h1 id="task9geo下载表达矩阵所有样本中挑选所需要的探针"><a class="markdownIt-Anchor" href="#task9geo下载表达矩阵所有样本中挑选所需要的探针"></a> Task9：GEO下载表达矩阵，所有样本中挑选所需要的探针</h1>
<blockquote>
<p>下载数据集GSE42872的表达矩阵，并且分别挑选出所有样本的(平均表达量/sd/mad/)最大的探针，<br>
并且找到它们对应的基因。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">rm(list=ls())</span><br><span class="line">options(stringsAsFactors = F)   </span><br><span class="line">gse42872 &lt;- getGEO(&apos;GSE42872&apos;,</span><br><span class="line">                   AnnotGPL = F,     ## 注释文件</span><br><span class="line">                   getGPL = F)       ## 平台文件</span><br><span class="line">show(gse42872)</span><br><span class="line">dat &lt;- as.data.frame(exprs(gse42872[[1]]))</span><br><span class="line">pdata_42872 &lt;- pData(gse42872[[1]]) </span><br><span class="line">pdata_42872 &lt;- pdata_42872$source_name_ch1</span><br><span class="line">pdata_42872 &lt;- data.frame(Group = pdata_42872)</span><br><span class="line"></span><br><span class="line">max_mean &lt;- names(sort(apply(dat,1, mean), decreasing = T))[1]</span><br><span class="line">max_sd &lt;- names(sort(apply(dat,1, sd), decreasing = T))[1]</span><br><span class="line">max_mad &lt;- names(sort(apply(dat,1, mad), decreasing = T))[1]</span><br><span class="line">str(max_max)</span><br><span class="line">library(hugene10sttranscriptcluster.db)</span><br><span class="line">list(hugene10sttranscriptcluster.db)</span><br><span class="line">###find the corresponding genes for the probes</span><br><span class="line">ids &lt;- toTable(hugene10sttranscriptclusterSYMBOL)</span><br><span class="line">ids[match(max_mad, ids$probe_id),]</span><br><span class="line">#或者</span><br><span class="line">select(hugene10sttranscriptcluster.db,</span><br><span class="line">       keys = c(max_sd, max_mad, max_mean),</span><br><span class="line">       columns = c(&quot;SYMBOL&quot;),</span><br><span class="line">       keytype = &quot;PROBEID&quot;)</span><br><span class="line">##注意，max_mad探针对应着很多基因名</span><br></pre></td></tr></table></figure>
<h1 id="10-task10"><a class="markdownIt-Anchor" href="#10-task10"></a> 10 Task10</h1>
<blockquote>
<p>这部分内容参考http://www.bio-info-trainee.com/bioconductor_China/software/limma.html<br>
下载数据集GSE42872的表达矩阵，并且根据分组使用limma做差异分析，<br>
得到差异结果矩阵</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">library(GEOquery)</span><br><span class="line">rm(list=ls())</span><br><span class="line">options(stringsAsFactors = F)   </span><br><span class="line">gse42872 &lt;- getGEO(&apos;GSE42872&apos;, GSEMatrix = TRUE,</span><br><span class="line">                   AnnotGPL = F,     ## 注释文件</span><br><span class="line">                   getGPL = F)       ## 平台文件</span><br><span class="line">show(gse42872)</span><br><span class="line">dat &lt;- as.data.frame(exprs(gse42872[[1]]))</span><br><span class="line">pdata_42872 &lt;- pData(gse42872[[1]]) </span><br><span class="line">pdata_42872 &lt;- pdata_42872$title</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">group &lt;- unlist(lapply(pdata_42872, function(x)</span><br><span class="line">&#123;</span><br><span class="line">  strsplit(x,&apos; &apos;)[[1]][4]</span><br><span class="line">&#125;</span><br><span class="line">  ))</span><br><span class="line">#pdata_42872 &lt;- data.frame(Group = pdata_42872)</span><br><span class="line">library(hugene10sttranscriptcluster.db)</span><br><span class="line">ids &lt;- toTable(hugene10sttranscriptclusterSYMBOL)</span><br><span class="line">dim(ids)</span><br><span class="line">dim(dat)</span><br><span class="line"># &gt; dim(ids)</span><br><span class="line"># [1] 19827     2</span><br><span class="line"># &gt; dim(dat)</span><br><span class="line"># [1] 33297     6</span><br><span class="line">#很多探针没有注释信息，进行过滤,/可以用merge但是需要加列</span><br><span class="line">dat_filter &lt;- dat[match(ids$probe_id,rownames(dat)),]</span><br><span class="line">dim(dat_filter)</span><br><span class="line">#用%in%进行筛选</span><br><span class="line">dat_filter2 &lt;- dat[rownames(dat) %in% ids$probe_id,]</span><br><span class="line"># &gt; dim(dat_filter)</span><br><span class="line"># [1] 19827     6</span><br><span class="line">#dat_filter is the expression matrix</span><br></pre></td></tr></table></figure>
<h2 id="差异表达分析"><a class="markdownIt-Anchor" href="#差异表达分析"></a> 差异表达分析</h2>
<p>需要分组矩阵（design），比较矩阵（contrast）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">library(limma)</span><br><span class="line">##########分组矩阵design，group中的说明。1代表是。用于每张芯片的RNA样本分类</span><br><span class="line">design &lt;- model.matrix(~0+factor(group))</span><br><span class="line">colnames(design) &lt;- levels(factor(group))</span><br><span class="line">rownames(design) &lt;- colnames(dat_filter)</span><br><span class="line">design</span><br><span class="line"># Control Vemurafenib</span><br><span class="line"># GSM1052615       1           0</span><br><span class="line"># GSM1052616       1           0</span><br><span class="line"># GSM1052617       1           0</span><br><span class="line"># GSM1052618       0           1</span><br><span class="line"># GSM1052619       0           1</span><br><span class="line"># GSM1052620       0           1</span><br><span class="line">###############比较矩阵</span><br><span class="line">colnames(design) &lt;- levels(factor(group))</span><br><span class="line">rownames(design) &lt;- colnames(dat_filter)</span><br><span class="line">design</span><br><span class="line">#再做一个比较矩阵【一般是case比control】，规定实验组和对照组并定义谁比谁</span><br><span class="line">contrast.matrix&lt;-makeContrasts(paste0(unique(group),collapse = &quot;-&quot;),levels = design)</span><br><span class="line">#或者下面。注意是Vemurafenib/Control</span><br><span class="line">contrast.matrix_2 &lt;- makeContrasts(&quot;Vemurafenib-Control&quot; ,levels = design)</span><br></pre></td></tr></table></figure>
<h2 id="筛选差异基因degs"><a class="markdownIt-Anchor" href="#筛选差异基因degs"></a> 筛选差异基因DEGs</h2>
<p>###分步进行1，这步用到实验设计矩阵</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fit &lt;- lmFit(dat_filer, design)</span><br></pre></td></tr></table></figure>
<p>###分步进行2，用到比较矩阵</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fit2 &lt;- contrasts.fit(fit, contrast.matrix)</span><br><span class="line">fit2 &lt;- eBayes(fit2)</span><br></pre></td></tr></table></figure>
<p>###分步进行3</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tem_output &lt;- topTable(fit2, coef = 1, n= Inf)</span><br><span class="line">mydegs &lt;- na.omit(tem_output)</span><br></pre></td></tr></table></figure>
<p>###写成函数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">deg&lt;- function(dat_filter,design,contrast)&#123;</span><br><span class="line">  ##step1</span><br><span class="line">  fit &lt;- lmFit(dat_filter,design)#用到实验设计矩阵</span><br><span class="line">  ##step2</span><br><span class="line">  fit2 &lt;- contrasts.fit(fit, contrast) #用到比较矩阵</span><br><span class="line">  fit2 &lt;- eBayes(fit2)  </span><br><span class="line">  ##step3</span><br><span class="line">  mtx = topTable(fit2, coef=1, n=Inf)</span><br><span class="line">  deg_mtx = na.omit(mtx) </span><br><span class="line">  return(deg_mtx)</span><br><span class="line">&#125;</span><br><span class="line">deg_mtx &lt;- DEG(dat_filter,design,contrast) #得到全部的差异基因矩阵</span><br><span class="line">head(DEG_mtx)</span><br></pre></td></tr></table></figure>
<h2 id="下面和symbole对应"><a class="markdownIt-Anchor" href="#下面和symbole对应"></a> 下面和symbole对应</h2>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">library(hugene10sttranscriptcluster.db)</span><br><span class="line">ids &lt;- toTable(hugene10sttranscriptclusterSYMBOL)</span><br><span class="line">deg_mtx$probe_id &lt;- rownames(deg_mtx)</span><br><span class="line">deg_mtx &lt;- merge(ids,deg_mtx, by = &apos;probe_id&apos;)</span><br><span class="line">write.csv(deg_mtx, &apos;GSE42872_DEGs_limma.csv&apos;, quote = F)</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="entry-meta entry-footer">
      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/categories/R/">R</a>

      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/R/">R</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/生物信息学/">生物信息学</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/统计/">统计</a></li></ul>

      
        
	<div id="comment">
		<!-- 来必力City版安装代码 -->
		<div id="lv-container" data-id="city" data-uid="MTAyMC8yOTQ4MS82MDQ5">
		<script type="text/javascript">
		   (function(d, s) {
		       var j, e = d.getElementsByTagName(s)[0];

		       if (typeof LivereTower === 'function') { return; }

		       j = d.createElement(s);
		       j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
		       j.async = true;

		       e.parentNode.insertBefore(j, e);
		   })(document, 'script');
		</script>
		<noscript>为正常使用来必力评论功能请激活JavaScript</noscript>
		</div>
		<!-- City版安装代码已完成 -->
	</div>



      
    </footer>
    <hr class="entry-footer-hr">
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2019/04/29/网页右上角显示github/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">上一篇</strong>
      <div class="article-nav-title">
        
          github图表加到网页角落
        
      </div>
    </a>
  
  
    <a href="/2019/04/29/同一个github账户绑定两个域名/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">下一篇</strong>
      <div class="article-nav-title">同一个github账户绑定两个域名</div>
    </a>
  
</nav>

  
</article>

<!-- Table of Contents -->

  <aside id="sidebar">
    <div id="toc" class="toc-article">
    <strong class="toc-title">文章目录</strong>
    
      <ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#task1-通过r注释包从ensemble到symbol"><span class="nav-number">1.</span> <span class="nav-text"> Task1: 通过R注释包从ensemble到symbol</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#method1for循环"><span class="nav-number">1.1.</span> <span class="nav-text"> Method1:for循环</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#method2apply函数"><span class="nav-number">1.2.</span> <span class="nav-text"> Method2:apply函数</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#task2由探针找到对应的基因名"><span class="nav-number">2.</span> <span class="nav-text"> Task2:由探针找到对应的基因名</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#task3-找某个基因在表达矩阵中的值并分组绘图"><span class="nav-number">3.</span> <span class="nav-text"> Task3 找某个基因在表达矩阵中的值并分组绘图</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#task4对任意肿瘤的任意基因进行分类做图用cbioportal"><span class="nav-number">4.</span> <span class="nav-text"> Task4:对任意肿瘤的任意基因进行分类做图（用cBioPortal）</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#task5某基因在某肿瘤中的生存曲线作图美化"><span class="nav-number">5.</span> <span class="nav-text"> Task5:某基因在某肿瘤中的生存曲线作图美化</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#task6geo下载表达数据并提取特定的基因做热图要去重复"><span class="nav-number">6.</span> <span class="nav-text"> Task6：GEO下载表达数据并提取特定的基因做热图（要去重复）</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#有三种方法得到表达数据"><span class="nav-number">6.1.</span> <span class="nav-text"> 有三种方法得到表达数据</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1下载cel格式文件自己进行处理"><span class="nav-number">6.1.1.</span> <span class="nav-text"> 1.下载.CEL格式文件，自己进行处理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2手动下载series-matrix-files然后读入"><span class="nav-number">6.1.2.</span> <span class="nav-text"> 2.手动下载series Matrix Files，然后读入</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3利用r下载表达数据"><span class="nav-number">6.1.3.</span> <span class="nav-text"> 3.利用R下载表达数据</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#task7geo下载表达矩阵做样本的相关性热图需要标记样本分组信息"><span class="nav-number">7.</span> <span class="nav-text"> Task7:GEO下载表达矩阵做样本的相关性热图，需要标记样本分组信息</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#task8-找到芯片对应平台的注释包并进行安装"><span class="nav-number">8.</span> <span class="nav-text"> Task8： 找到芯片对应平台的注释包并进行安装</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#task9geo下载表达矩阵所有样本中挑选所需要的探针"><span class="nav-number">9.</span> <span class="nav-text"> Task9：GEO下载表达矩阵，所有样本中挑选所需要的探针</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#10-task10"><span class="nav-number">10.</span> <span class="nav-text"> 10 Task10</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#差异表达分析"><span class="nav-number">10.1.</span> <span class="nav-text"> 差异表达分析</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#筛选差异基因degs"><span class="nav-number">10.2.</span> <span class="nav-text"> 筛选差异基因DEGs</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#下面和symbole对应"><span class="nav-number">10.3.</span> <span class="nav-text"> 下面和symbole对应</span></a></li></ol></li></ol>
    
    </div>
  </aside>


</section>
        
      </div>

    </div>
    <!-- <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/categories" class="mobile-nav-link">Categories</a>
  
    <a href="/tags" class="mobile-nav-link">Tags</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/links" class="mobile-nav-link">links</a>
  
    <a href="/about" class="mobile-nav-link">About</a>
  
</nav> -->
    <footer id="footer" class="site-footer">
  

  <div class="clearfix container">
      <div class="site-info">
	      &copy; 2019 K2 life All Rights Reserved.
        
            <span id="busuanzi_container_site_uv">
              本站访客数<span id="busuanzi_value_site_uv"></span>人次  
              本站总访问量<span id="busuanzi_value_site_pv"></span>次
            </span>
          
      </div>
      <div class="site-credit">
        Theme by <a href="https://github.com/iTimeTraveler/hexo-theme-hipaper" target="_blank">hipaper</a>
      </div>
  </div>
</footer>


<!-- min height -->

<script>
    var wrapdiv = document.getElementById("wrap");
    var contentdiv = document.getElementById("content");

    wrapdiv.style.minHeight = document.body.offsetHeight - document.getElementById("allheader").offsetHeight - document.getElementById("footer").offsetHeight + "px";
    contentdiv.style.minHeight = document.body.offsetHeight - document.getElementById("allheader").offsetHeight - document.getElementById("footer").offsetHeight + "px";


    <!-- headerblur min height -->
    
    
</script>
    
<div style="display: none;">
  <script src="https://s11.cnzz.com/z_stat.php?id=1260716016&web_id=1260716016" language="JavaScript"></script>
</div>

<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>
<script src="/js/bootstrap.js"></script>
<script src="/js/main.js"></script>







  <div style="display: none;">
    <script src="https://s95.cnzz.com/z_stat.php?id=1260716016&web_id=1260716016" language="JavaScript"></script>
  </div>



	<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
	</script>






  </div>

  <a id="rocket" href="#top" class=""></a>
  <script type="text/javascript" src="/js/totop.js" async=""></script>
</body>
</html>
